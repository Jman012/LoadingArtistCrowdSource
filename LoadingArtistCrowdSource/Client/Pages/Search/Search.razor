@page "/search"
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject Services.LACSApi Api

@if (fields == null)
{
	<div class="d-flex justify-content-center">
		<div class="spinner-border" role="status">
			<span class="sr-only">Loading...</span>
		</div>
	</div>
}
else
{
	<Container Fluid="false">
		<Row>
			<Column>
				<h1>Search</h1>

				<div class="d-flex">
					<h3>Search Terms</h3>
					<div class="flex-fill"></div>
					<Button Type="ButtonType.Button" Outline="true" Color="Color.Secondary" title="Add new search term">
						<span class="oi oi-plus" aria-hidden="true"></span>
					</Button>
				</div>
				<div class="d-flex flex-wrap">
					@foreach (var field in fields)
					{
						<div class="m-2">
							<FilterItem2 Field="field"></FilterItem2>
						</div>
					}

				</div>

				<h3>Results</h3>
				<div>

				</div>
			</Column>
		</Row>
	</Container>
}

@code {
	private ComicFieldViewModel[]? fields { get; set; } = null;

	protected override async Task OnInitializedAsync()
	{
		try
		{
			fields = await Api.GetSearch();
		}
		catch (AccessTokenNotAvailableException exception)
		{
			exception.Redirect();
		}

		await base.OnInitializedAsync();
	}
}
